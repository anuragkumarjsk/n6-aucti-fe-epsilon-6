{"ast":null,"code":"import _regeneratorRuntime from\"D:/Projects/Aucti/aucti-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(login),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(logout),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(watchLoginUser),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(watchLogoutUser),_marked5=/*#__PURE__*/_regeneratorRuntime.mark(userSaga);import{takeEvery,call,put,all}from\"redux-saga/effects\";import history from\"../../routes/history\";import{AUTH}from\"../types\";import*as service from\"../services/userService\";import*as actions from\"../actions/userActions\";import*as alert from\"../actions/alertActions\";function login(){var _result$additionalUse,result,user;return _regeneratorRuntime.wrap(function login$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return call(service.login);case 3:result=_context.sent;user=result.user;_context.next=7;return put(actions.userLoggedIn(user));case 7:_context.next=9;return put(alert.setAlertAction({text:\"User Logged In!\",text_color:\"text-blue-700\",bg_color:\"bg-blue-100\"}));case 9:if(result===null||result===void 0?void 0:(_result$additionalUse=result.additionalUserInfo)===null||_result$additionalUse===void 0?void 0:_result$additionalUse.isNewUser){console.log(\"new user\");console.log(history);history.push(\"/register\");}else{history.push(\"/\");}_context.next=17;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](0);_context.next=16;return put(alert.setAlertAction({text:_context.t0.msg,text_color:\"text-red-700\",bg_color:\"bg-red-100\"}));case 16:console.log(_context.t0);case 17:case\"end\":return _context.stop();}}},_marked,null,[[0,12]]);}function logout(){return _regeneratorRuntime.wrap(function logout$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return call(service.logout);case 2:_context2.next=4;return put(actions.userLoggedOutAction());case 4:history.push(\"/\");case 5:case\"end\":return _context2.stop();}}},_marked2);}function watchLoginUser(){return _regeneratorRuntime.wrap(function watchLoginUser$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return takeEvery(AUTH.LOGIN_USER,login);case 2:case\"end\":return _context3.stop();}}},_marked3);}function watchLogoutUser(){return _regeneratorRuntime.wrap(function watchLogoutUser$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return takeEvery(AUTH.LOGOUT_USER,logout);case 2:case\"end\":return _context4.stop();}}},_marked4);}export function userSaga(){return _regeneratorRuntime.wrap(function userSaga$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return all([watchLoginUser(),watchLogoutUser()]);case 2:case\"end\":return _context5.stop();}}},_marked5);}","map":{"version":3,"sources":["D:/Projects/Aucti/aucti-web/src/redux/saga/userSaga.js"],"names":["login","logout","watchLoginUser","watchLogoutUser","userSaga","takeEvery","call","put","all","history","AUTH","service","actions","alert","result","user","userLoggedIn","setAlertAction","text","text_color","bg_color","additionalUserInfo","isNewUser","console","log","push","msg","userLoggedOutAction","LOGIN_USER","LOGOUT_USER"],"mappings":"2LASUA,K,iDAgCAC,M,iDAMAC,c,iDAIAC,e,iDAIOC,Q,EAvDjB,OAASC,SAAT,CAAoBC,IAApB,CAA0BC,GAA1B,CAA+BC,GAA/B,KAA0C,oBAA1C,CAEA,MAAOC,CAAAA,OAAP,KAAoB,sBAApB,CAEA,OAASC,IAAT,KAAqB,UAArB,CACA,MAAO,GAAKC,CAAAA,OAAZ,KAAyB,yBAAzB,CACA,MAAO,GAAKC,CAAAA,OAAZ,KAAyB,wBAAzB,CACA,MAAO,GAAKC,CAAAA,KAAZ,KAAuB,yBAAvB,CAEA,QAAUb,CAAAA,KAAV,uLAEiB,MAAMM,CAAAA,IAAI,CAACK,OAAO,CAACX,KAAT,CAAV,CAFjB,OAEQc,MAFR,eAGQC,IAHR,CAGeD,MAAM,CAACC,IAHtB,iBAIE,MAAMR,CAAAA,GAAG,CAACK,OAAO,CAACI,YAAR,CAAqBD,IAArB,CAAD,CAAT,CAJF,uBAKE,MAAMR,CAAAA,GAAG,CACRM,KAAK,CAACI,cAAN,CAAqB,CACpBC,IAAI,CAAE,iBADc,CAEpBC,UAAU,CAAE,eAFQ,CAGpBC,QAAQ,CAAE,aAHU,CAArB,CADQ,CAAT,CALF,OAaE,GAAIN,MAAJ,SAAIA,MAAJ,wCAAIA,MAAM,CAAEO,kBAAZ,gDAAI,sBAA4BC,SAAhC,CAA2C,CAC1CC,OAAO,CAACC,GAAR,CAAY,UAAZ,EACAD,OAAO,CAACC,GAAR,CAAYf,OAAZ,EACAA,OAAO,CAACgB,IAAR,CAAa,WAAb,EACA,CAJD,IAIO,CACNhB,OAAO,CAACgB,IAAR,CAAa,GAAb,EACA,CAnBH,kGAqBE,MAAMlB,CAAAA,GAAG,CACRM,KAAK,CAACI,cAAN,CAAqB,CACpBC,IAAI,CAAE,YAAEQ,GADY,CAEpBP,UAAU,CAAE,cAFQ,CAGpBC,QAAQ,CAAE,YAHU,CAArB,CADQ,CAAT,CArBF,QA4BEG,OAAO,CAACC,GAAR,cA5BF,qEAgCA,QAAUvB,CAAAA,MAAV,sIACC,MAAMK,CAAAA,IAAI,CAACK,OAAO,CAACV,MAAT,CAAV,CADD,wBAEC,MAAMM,CAAAA,GAAG,CAACK,OAAO,CAACe,mBAAR,EAAD,CAAT,CAFD,OAGClB,OAAO,CAACgB,IAAR,CAAa,GAAb,EAHD,wDAMA,QAAUvB,CAAAA,cAAV,8IACC,MAAMG,CAAAA,SAAS,CAACK,IAAI,CAACkB,UAAN,CAAkB5B,KAAlB,CAAf,CADD,wDAIA,QAAUG,CAAAA,eAAV,+IACC,MAAME,CAAAA,SAAS,CAACK,IAAI,CAACmB,WAAN,CAAmB5B,MAAnB,CAAf,CADD,wDAIA,MAAO,SAAUG,CAAAA,QAAV,wIACN,MAAMI,CAAAA,GAAG,CAAC,CAACN,cAAc,EAAf,CAAmBC,eAAe,EAAlC,CAAD,CAAT,CADM","sourcesContent":["import { takeEvery, call, put, all } from \"redux-saga/effects\";\r\n\r\nimport history from \"../../routes/history\";\r\n\r\nimport { AUTH } from \"../types\";\r\nimport * as service from \"../services/userService\";\r\nimport * as actions from \"../actions/userActions\";\r\nimport * as alert from \"../actions/alertActions\";\r\n\r\nfunction* login() {\r\n\ttry {\r\n\t\tconst result = yield call(service.login);\r\n\t\tconst user = result.user;\r\n\t\tyield put(actions.userLoggedIn(user));\r\n\t\tyield put(\r\n\t\t\talert.setAlertAction({\r\n\t\t\t\ttext: \"User Logged In!\",\r\n\t\t\t\ttext_color: \"text-blue-700\",\r\n\t\t\t\tbg_color: \"bg-blue-100\",\r\n\t\t\t})\r\n\t\t);\r\n\r\n\t\tif (result?.additionalUserInfo?.isNewUser) {\r\n\t\t\tconsole.log(\"new user\");\r\n\t\t\tconsole.log(history);\r\n\t\t\thistory.push(\"/register\");\r\n\t\t} else {\r\n\t\t\thistory.push(\"/\");\r\n\t\t}\r\n\t} catch (e) {\r\n\t\tyield put(\r\n\t\t\talert.setAlertAction({\r\n\t\t\t\ttext: e.msg,\r\n\t\t\t\ttext_color: \"text-red-700\",\r\n\t\t\t\tbg_color: \"bg-red-100\",\r\n\t\t\t})\r\n\t\t);\r\n\t\tconsole.log(e);\r\n\t}\r\n}\r\n\r\nfunction* logout() {\r\n\tyield call(service.logout);\r\n\tyield put(actions.userLoggedOutAction());\r\n\thistory.push(\"/\");\r\n}\r\n\r\nfunction* watchLoginUser() {\r\n\tyield takeEvery(AUTH.LOGIN_USER, login);\r\n}\r\n\r\nfunction* watchLogoutUser() {\r\n\tyield takeEvery(AUTH.LOGOUT_USER, logout);\r\n}\r\n\r\nexport function* userSaga() {\r\n\tyield all([watchLoginUser(), watchLogoutUser()]);\r\n}\r\n"]},"metadata":{},"sourceType":"module"}